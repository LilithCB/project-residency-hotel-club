{{>navbar}}
<div class="max-w-6xl mx-auto ">
  <!-- Header -->
  <header class="text-center py-16">
    <h1 class="text-3xl font-extrabold text-blue-900 tracking-tight">Habitaciones</h1>
   {{>buttons}}
  </header>

  <!-- Tabla de Habitaciones -->
  <section id="tableSection">
    <table class="min-w-full bg-white border border-gray-200 shadow-xl rounded-xl overflow-hidden">
      <thead class="bg-blue-800 text-white text-sm uppercase">
        <tr>
          <th class="py-2 px-4 text-left">Número</th>
          <th class="py-2 px-4 text-left">Tipo</th>
          <th class="py-2 px-4 text-left">Estado</th>
          <th class="py-2 px-4 text-center">Acciones</th>
        </tr>
      </thead>

      <tbody class="text-gray-700 divide-y divide-gray-200">
        {{#each habitaciones}}
        <tr class="hover:bg-gray-50 transition">
          <td class="py-2 px-4 capitalize">{{this.numero}}</td>
          <td class="py-2 px-4 capitalize">{{this.tipo}}</td>
          <td class="py-2 px-4 font-semibold">
            {{#if (eq this.estado 'disponible')}}
              <span class="px-2 py-0.5 rounded-md bg-gray-200 text-gray-800 text-sm">Disponible</span>
            {{/if}}
            {{#if (eq this.estado 'ocupado')}}
              <span class="px-2 py-0.5 rounded-md bg-red-100 text-red-700 text-sm">Ocupado</span>
            {{/if}}
            {{#if (eq this.estado 'limpieza')}}
              <span
                class="px-2 py-0.5 rounded-md bg-orange-100 text-orange-700 text-sm cursor-pointer"
                onclick="openModal({{this.id}})"
              >
                Limpieza
              </span>
            {{/if}}
          </td>

          <td class="py-2 px-4 flex flex-wrap justify-center gap-2">
            <!-- Reservar: redirige a tu formulario de reservación -->
            <a href="/rooms/reservar/{{this.id}}"
               class="px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg shadow-sm transition">
               Reservar
            </a>

            <!-- Rentar: redirige a tu formulario de renta -->
            <a href="/rooms/rentar/{{this.id}}"
               class="px-2 py-1 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg shadow-sm transition">
               Rentar
            </a>
          </td>
        </tr>

        {{!-- Modal para confirmar limpieza --}}
        {{#if (eq this.estado 'limpieza')}}
        <div id="modal-clean-{{this.id}}" class="fixed inset-0 z-50 items-center justify-center bg-black bg-opacity-40 hidden">
          <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
            <h2 class="text-xl font-bold mb-4 text-orange-700">Confirmar limpieza</h2>
            <p class="mb-6 text-gray-700">¿Estás seguro de que deseas cambiar el estado a <span class="font-bold text-gray-800">Disponible</span> para la habitación <span class="font-bold">{{this.numero}}</span>?</p>
            <form action="/rooms/changes/status/{{this.id}}" method="POST" class="flex flex-col gap-3">
              <input type="hidden" name="status" value="disponible" />
              <div class="flex justify-end gap-2">
                <button type="button" onclick="closeModal({{this.id}})" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg font-semibold">Cancelar</button>
                <button type="submit" class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold">Confirmar</button>
              </div>
            </form>
          </div>
        </div>
        {{/if}}
        {{/each}}
      </tbody>
    </table>
  </section>
</div>

<script>
  function openModal(id) {
    document.getElementById('modal-clean-' + id).style.display = 'flex';
  }
  function closeModal(id) {
    document.getElementById('modal-clean-' + id).style.display = 'none';
  }
</script>
